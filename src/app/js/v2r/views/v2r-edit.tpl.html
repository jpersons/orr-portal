<uib-tabset style="width: 100%">

  <uib-tab ng-repeat="vocab in vm.v2r.vocabs"
           style="cursor: pointer">

    <tab-heading>

      <div>
        <button ng-click="editVocabClass(vocab.class)" class="btn btn-link"
                ng-disabled="vm.someCellBeingEdited || attrTableform.$waiting">
          {{getName(vocab.class)}} <i class="fa fa-edit" aria-hidden="true"></i>
        </button>
      </div>

    </tab-heading>


    <table class="table table-bordered">
      <thead>
      <tr>

        <th style="width: 10px">
        </th>

        <th style="width: 5%; vertical-align: middle">ID</th>

        <th ng-repeat="p in vocab.properties">
          <button ng-click="editVocabProperty(p)" class="btn btn-link"
                  ng-disabled="vm.someCellBeingEdited || attrTableform.$waiting">
            {{getLabel(p)}} <i class="fa fa-edit" aria-hidden="true"></i>
          </button>
        </th>
      </tr>
      </thead>

      <tbody>
      <tr ng-repeat="t in vocab.terms track by $index" ng-init="t_index = $index">

        <td style="width: 10px">
          <button type="button"
                  ng-disabled="vm.someCellBeingEdited || attrTableform.$waiting"
                  ng-click="removeTerm(vocab, t_index)"
                  class="btn btn-danger btn-xs"
                  uib-tooltip="Remove this term"
                  tooltip-placement="right"
          >
            <i class="fa fa-remove" aria-hidden="true"></i>
          </button>
        </td>

        <td style="width: 5%">
          <span editable-text="t.name" buttons="no" onbeforesave="checkTermId($data)"
                ng-bind="t.name || 'empty'"
          >
          </span>
        </td>

        <td ng-repeat="a in t.attributes track by $index" ng-init="a_index = $index"
            ng-style="attrTableform.$visible ? {'background-color': '#fbeacb'} : {}"
        >
          <div ng-init="em = getAttrEditModel(a)">

            <div>
              <form editable-form name="attrTableform"
                    onaftersave="applyCellChanges(t.attributes, a_index, em)"
                    oncancel="cancelCell(em)">

                <table class="table table-hover table-condensed"
                       ng-click="enterCellEditing(attrTableform)"
                       uib-tooltip="{{!attrTableform.$visible && !vm.someCellBeingEdited ? 'Click to edit the value(s) for this property' : ''}}"
                >
                  <tr ng-repeat="valueEntry in em | filter:filterValue track by $index">
                    <td>
                      <span editable-textarea="valueEntry.value"
                            e-rows="2"
                            e-form="attrTableform"
                            ng-bind="valueEntry.value || 'empty'"
                      >
                      </span>
                      <!--<pre ng-bind="'valueEntry=' +(valueEntry|json)"></pre>-->
                    </td>
                    <td ng-show="attrTableform.$visible" style="width: 10px">
                      <button type="button" ng-click="deleteValue(em, valueEntry.id)"
                              class="btn btn-danger btn-xs pull-right"
                              uib-tooltip="Remove this value"
                              tooltip-placement="left"
                      >
                        <i class="fa fa-times" aria-hidden="true"></i>
                      </button>
                    </td>
                  </tr>
                  <tr ng-show="attrTableform.$visible">
                    <td style="text-align: center" colspan="2">
                      <button type="button" ng-disabled="attrTableform.$waiting"
                              ng-click="addValue(em)"
                              class="btn btn-default btn-xs"
                      >
                        <i class="fa fa-plus" aria-hidden="true"></i> Add value
                      </button>

                    </td>
                  </tr>
                </table>

                <!--<pre ng-bind="em | json"></pre>-->

                <div class="btn-form" ng-show="attrTableform.$visible">
                  <button type="submit" ng-disabled="attrTableform.$waiting"
                          class="btn btn-default btn-xs"
                          uib-tooltip="Apply all changes in this cell">
                    <i class="fa fa-check" aria-hidden="true"></i> Apply
                  </button>
                  <button type="button" ng-disabled="attrTableform.$waiting"
                          class="btn btn-default btn-xs pull-right"
                          ng-click="attrTableform.$cancel()"
                          uib-tooltip="Cancel all changes to this cell"
                          tooltip-placement="left"
                  >
                    Cancel
                  </button>
                </div>

              </form>
            </div>

          </div>
        </td>

      </tr>

      <tr>
        <td style="text-align: center">
          <button type="button"
                  ng-disabled="vm.someCellBeingEdited || attrTableform.$waiting"
                  ng-click="addTerm(vocab)"
                  class="btn btn-default btn-xs"
                  uib-tooltip="Add term"
                  tooltip-placement="right"
          >
            <i class="fa fa-plus" aria-hidden="true"></i>
          </button>
        </td>
      </tr>

      </tbody>
    </table>

  </uib-tab>

</uib-tabset>
