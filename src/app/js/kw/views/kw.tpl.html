<div style="width: 100%">
<div style="margin-left: 20px; margin-right: 10px">

  <h3>
    Keyword search
  </h3>

  <table class="stInputSection" style="width: 100%">
    <tbody>
    <tr>
      <td>
        <table style="margin: 6px">
          <tr>
            <td>
              <label style="margin-right: 6px">
                Keywords separated by commas:
              </label>
            </td>
            <td>
              <div style="display: inline-block; position: relative">
                <input type="text" class="search form-control" style="width: 300px"
                       ng-model="vm.kw" ng-keypress="searchKeyPressed($event)"
                       ng-change="filterData()"
                       focus-on="kwStringInput_form_activation"
                       uib-popover="Press Enter or click button to capture search in URL and perform search"
                       popover-placement="bottom"
                       popover-trigger="mouseenter"
                  >
                  <span style="position: absolute; top: 5px; right: 5px"
                        ng-show="!!vm.kw"
                        ng-click="clearSearch()">
                      <span class="fa fa-times"></span>
                  </span>
              </div>

            </td>
            <td>
              <button class="btn btn-default btn-xs" ng-click="searchButtonClicked()"
                      uib-popover="Capture search in URL and perform search"
                      popover-placement="bottom"
                      popover-trigger="mouseenter"
                >
                <span class="fa fa-search"></span>
              </button>
            </td>
          </tr>
        </table>
      </td>
    </tr>
    </tbody>
  </table>

  <br/>

  <div ng-if="vm.querySource">
    <div style="width: 10em;"
         ng-mouseenter="vm._showQuerySourcePopup=true" ng-mouseleave="vm._showQuerySourcePopup=undefined"
    >
      <script type="text/ng-template" id="stQuerySourcePopup.html">
        <div ng-mouseleave="vm._showQuerySourcePopup=undefined"
             class="querySource">
          Query:
          <pre ng-bind="vm.querySource"></pre>
        </div>
      </script>
      <label uib-popover-template="'stQuerySourcePopup.html'"
             popover-placement="right"
             popover-is-open="vm.querySource && vm._showQuerySourcePopup"
      >
        Result:
      </label>
    </div>
  </div>

  <div ng-if="items && items.length">
    <items-viewer column-defs="columnDefs" items="items"></items-viewer>
  </div>

  <div ng-if="vm.gotResults && !vm.searching && (!items || items.length === 0)"
    style="color: peru">
    No entities found
  </div>

  <div ng-if="vm.searching">
    <span class="fa fa-spinner fa-spin fa-lg"></span>
    Searching ...
  </div>

  <pre ng-if="vm.error" ng-bind="vm.error" style="color: darkred; font-family: monospace">
  </pre>

</div>
</div>
